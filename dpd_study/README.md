# Application of BEDwARS to characterize the cell type-specific regulomes of DPD-deficient patients

In the following, the steps to preprocess the single cell data, generate signatures and pseudo bulk samples for batch correction are explained.
Data related to DPD analyis should be downloaded first. To download the DPD data navigate to `dpd_data` directory and run `./download.sh`. Make sure that you have `gdown` installed. `gdown` is already installed in the virtual environment (venv) created for BEDwARS (read BEDwARS documentation on activating the `venv`). After downling the data, run the notebooks in the represented order.

+  <details>
   <summary><strong>Quality Control and Clustering</strong></summary>

    Run `qc_clustering.ipynb` to perform quality control and clustering of the single cell data using Scanpy. To reproduce the `anndata (adata)` object generated by the paper all the library versions should match the ones listed in the beginning of the notebook. It is very likely that you cannot reproduce the exact `adata` object, in this case simply load the `adata` object used by the paper to reproduce the results of the paper. Depending on what you choose the sequence of analyses is different as listed below,
   * `load_adata=True`: The `adata` generated by the paper will be loaded from `dpd_data/sc_process/write/DPD_res.h5ad`. As a result, quality control and clustering steps are skipped. You do not need to annotate the clusters with cell types as it has already been done.
   * `load_data=False`: The single cell data will be loaded from `dpd_data/scdata`. The quality control and clustering is performed from scratch. If the clustering is not the same as the clustering presented in the paper, i.e., `load_adata=True`, then you have to do cell type assignment following the procedure explained in the paper. This notebook generates all the data, such as statistically derived markers of each cluster, required to perform cell type assignment. Read "Methods" section of the paper for more details.
    
    </details>
